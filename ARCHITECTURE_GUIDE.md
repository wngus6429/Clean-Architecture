# ğŸ—ï¸ í´ë¦° ì•„í‚¤í…ì²˜ & DDD ì´ˆë³´ì ê°€ì´ë“œ

> ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ í´ë¦° ì•„í‚¤í…ì²˜ì™€ ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„(DDD)ë¥¼ ì´í•´í•´ë´…ì‹œë‹¤!

## ğŸ“š ëª©ì°¨

1. [í´ë¦° ì•„í‚¤í…ì²˜ë€?](#í´ë¦°-ì•„í‚¤í…ì²˜ë€)
2. [DDDë€?](#dddë€)
3. [í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ëª…](#í”„ë¡œì íŠ¸-êµ¬ì¡°-ì„¤ëª…)
4. [ì½”ë“œ íë¦„ ì´í•´í•˜ê¸°](#ì½”ë“œ-íë¦„-ì´í•´í•˜ê¸°)
5. [ì‹¤ì œ ì˜ˆì œë¡œ ë”°ë¼ê°€ê¸°](#ì‹¤ì œ-ì˜ˆì œë¡œ-ë”°ë¼ê°€ê¸°)

---

## ğŸ¯ í´ë¦° ì•„í‚¤í…ì²˜ë€?

### ì‰½ê²Œ ì„¤ëª…í•˜ë©´?

**"ì½”ë“œë¥¼ ì–‘íŒŒì²˜ëŸ¼ ì—¬ëŸ¬ ì¸µìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ì„¤ê³„ ë°©ë²•"**

- ğŸ§… **ì–‘íŒŒì˜ ì¤‘ì‹¬**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ê°€ì¥ ì¤‘ìš”í•œ í•µì‹¬)
- ğŸ§… **ì–‘íŒŒì˜ ë°”ê¹¥ì¸µ**: ë°ì´í„°ë² ì´ìŠ¤, API, UI ë“± (ë°”ë€” ìˆ˜ ìˆëŠ” ê²ƒë“¤)

### ì™œ ì´ë ‡ê²Œ í• ê¹Œ?

```
âŒ ë‚˜ìœ ì˜ˆ: ëª¨ë“  ê²ƒì´ ì„ì—¬ìˆëŠ” ì½”ë“œ
â”œâ”€â”€ API ì½”ë“œì— ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ê°€ ì§ì ‘...
â”œâ”€â”€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— HTTP ìš”ì²­ ì²˜ë¦¬ê°€...
â””â”€â”€ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë µê³ , ìˆ˜ì •í•˜ë©´ ë‹¤ ë§ê°€ì§ ğŸ’¥

âœ… ì¢‹ì€ ì˜ˆ: ì¸µìœ¼ë¡œ ë¶„ë¦¬ëœ ì½”ë“œ
â”œâ”€â”€ ê° ì¸µì€ ìê¸° ì—­í• ë§Œ ìˆ˜í–‰
â”œâ”€â”€ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ MySQLì—ì„œ PostgreSQLë¡œ ë°”ê¿”ë„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ê·¸ëŒ€ë¡œ!
â””â”€â”€ í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰½ê³ , ìœ ì§€ë³´ìˆ˜ê°€ í¸í•¨ âœ¨
```

### í•µì‹¬ ì›ì¹™: ì˜ì¡´ì„± ê·œì¹™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Presentation (API, UI)            â”‚  â† ë°”ê¹¥ì¸µ
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚   Application (UseCase)   â”‚     â”‚  â† ì¤‘ê°„ì¸µ
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚   â”‚   â”‚     Domain      â”‚     â”‚     â”‚  â† í•µì‹¬ì¸µ (ë¹„ì¦ˆë‹ˆìŠ¤)
â”‚   â”‚   â”‚   (Entities)    â”‚     â”‚     â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      Infrastructure (DB, ì™¸ë¶€ API)   â† ê°€ì¥ ë°”ê¹¥ì¸µ

í™”ì‚´í‘œ ë°©í–¥: ë°”ê¹¥ â†’ ì•ˆ (ì•ˆìª½ì€ ë°”ê¹¥ì„ ëª¨ë¦„!)
```

**ì˜ì¡´ì„± ê·œì¹™**: ì•ˆìª½ ì¸µì€ ë°”ê¹¥ìª½ ì¸µì„ ëª°ë¼ì•¼ í•©ë‹ˆë‹¤!

- âœ… `UseCase`ê°€ `Entity`ë¥¼ ì‚¬ìš©: OK
- âŒ `Entity`ê°€ `Database`ë¥¼ ì§ì ‘ ì‚¬ìš©: NO!

---

## ğŸ¨ DDDë€?

### Domain-Driven Design (ë„ë©”ì¸ ì£¼ë„ ì„¤ê³„)

**"ë¹„ì¦ˆë‹ˆìŠ¤(ë„ë©”ì¸)ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì½”ë“œë¥¼ ì„¤ê³„í•˜ëŠ” ë°©ë²•"**

### í•µì‹¬ ê°œë…

#### 1ï¸âƒ£ **Entity (ì—”í‹°í‹°)**

"ì‹¤ì œ ì„¸ê³„ì˜ ê°œë…ì„ ì½”ë“œë¡œ í‘œí˜„í•œ ê²ƒ"

```typescript
// ì˜ˆ: ê²Œì‹œê¸€(Post)ì´ë¼ëŠ” ê°œë…
interface Post {
  id: number; // ê³ ìœ  ì‹ë³„ì
  title: string; // ì œëª©
  content: string; // ë‚´ìš©
  author: string; // ì‘ì„±ì
}
```

**íŠ¹ì§•**:

- ê³ ìœ  IDê°€ ìˆìŒ (ê°™ì€ ë‚´ìš©ì´ì–´ë„ IDê°€ ë‹¤ë¥´ë©´ ë‹¤ë¥¸ ê°ì²´)
- ë¹„ì¦ˆë‹ˆìŠ¤ì˜ í•µì‹¬ ê°œë…
- ë°ì´í„°ë² ì´ìŠ¤ë‚˜ í”„ë ˆì„ì›Œí¬ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ

#### 2ï¸âƒ£ **Repository (ì €ì¥ì†Œ)**

"ì—”í‹°í‹°ë¥¼ ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¤ëŠ” ë°©ë²•"

```typescript
// "ì–´ë–»ê²Œ" ì €ì¥í• ì§€ëŠ” ëª°ë¼ë„ ë¼ìš”!
// "ë¬´ì—‡ì„" í•  ìˆ˜ ìˆëŠ”ì§€ë§Œ ì •ì˜
interface IPostRepository {
  findAll(): Promise<Post[]>; // ëª¨ë“  ê²Œì‹œê¸€ ê°€ì ¸ì˜¤ê¸°
  findById(id: number): Promise<Post | null>; // IDë¡œ ì°¾ê¸°
  create(data: CreatePostInput): Promise<Post>; // ìƒì„±
  update(id: number, data: UpdatePostInput): Promise<Post | null>; // ìˆ˜ì •
  delete(id: number): Promise<boolean>; // ì‚­ì œ
}
```

**í•µì‹¬**: ì¸í„°í˜ì´ìŠ¤(ê³„ì•½)ë§Œ ì •ì˜í•˜ê³ , ì‹¤ì œ êµ¬í˜„ì€ ë‚˜ì¤‘ì—!

#### 3ï¸âƒ£ **Use Case (ìœ ìŠ¤ì¼€ì´ìŠ¤)**

"ì‚¬ìš©ìê°€ í•˜ê³  ì‹¶ì€ ì¼"

```typescript
// ì˜ˆ: "ê²Œì‹œê¸€ì„ ì‘ì„±í•˜ê³  ì‹¶ì–´ìš”!"
class CreatePostUseCase {
  async execute(data: CreatePostInput): Promise<Post> {
    // 1. ì…ë ¥ê°’ ê²€ì¦
    if (!data.title) throw new Error("ì œëª©ì€ í•„ìˆ˜!");

    // 2. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì ìš©
    const sanitizedData = { ...data, title: data.title.trim() };

    // 3. ì €ì¥
    return await this.repository.create(sanitizedData);
  }
}
```

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ëª…

ìš°ë¦¬ í”„ë¡œì íŠ¸ëŠ” ì´ë ‡ê²Œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤:

```
backend/src/
â”œâ”€â”€ domain/                    ğŸ§  í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ (ê°€ì¥ ì•ˆìª½)
â”‚   â”œâ”€â”€ entities/
â”‚   â”‚   â””â”€â”€ post.entity.ts     "ê²Œì‹œê¸€ì´ ë¬´ì—‡ì¸ì§€" ì •ì˜
â”‚   â””â”€â”€ repositories/
â”‚       â””â”€â”€ post.repository.interface.ts  "ì €ì¥ì†Œê°€ í•  ìˆ˜ ìˆëŠ” ì¼" ì •ì˜
â”‚
â”œâ”€â”€ application/               ğŸ’¼ ì—…ë¬´ ë¡œì§ (ì¤‘ê°„ì¸µ)
â”‚   â””â”€â”€ use-cases/
â”‚       â”œâ”€â”€ create-post.use-case.ts      "ê²Œì‹œê¸€ ì‘ì„±" ì—…ë¬´
â”‚       â”œâ”€â”€ get-all-posts.use-case.ts    "ê²Œì‹œê¸€ ëª©ë¡ ë³´ê¸°" ì—…ë¬´
â”‚       â”œâ”€â”€ get-post-by-id.use-case.ts   "ê²Œì‹œê¸€ ìƒì„¸ ë³´ê¸°" ì—…ë¬´
â”‚       â”œâ”€â”€ update-post.use-case.ts      "ê²Œì‹œê¸€ ìˆ˜ì •" ì—…ë¬´
â”‚       â””â”€â”€ delete-post.use-case.ts      "ê²Œì‹œê¸€ ì‚­ì œ" ì—…ë¬´
â”‚
â”œâ”€â”€ infrastructure/            ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ (ë°”ê¹¥ì¸µ)
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ drizzle.ts         ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°
â”‚   â”‚   â””â”€â”€ schema.ts          ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ì •ì˜
â”‚   â””â”€â”€ repositories/
â”‚       â””â”€â”€ drizzle-post.repository.ts  "ì‹¤ì œë¡œ DBì— ì €ì¥í•˜ëŠ” ë°©ë²•"
â”‚
â””â”€â”€ presentation/              ğŸŒ ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ (ê°€ì¥ ë°”ê¹¥ì¸µ)
    â”œâ”€â”€ routes/
    â”‚   â””â”€â”€ post.routes.ts     API ì—”ë“œí¬ì¸íŠ¸ (GET, POST, PUT, DELETE)
    â””â”€â”€ schemas/
        â””â”€â”€ post.schema.ts     ì…ë ¥ ê²€ì¦ ìŠ¤í‚¤ë§ˆ
```

### ê° ì¸µì˜ ì—­í• 

| ì¸µ                 | í´ë”              | ì—­í•                | ì˜ˆì‹œ                                         |
| ------------------ | ----------------- | ------------------ | -------------------------------------------- |
| **Domain**         | `domain/`         | ë¹„ì¦ˆë‹ˆìŠ¤ ê°œë… ì •ì˜ | "ê²Œì‹œê¸€ì€ ì œëª©, ë‚´ìš©, ì‘ì„±ìê°€ ìˆì–´ìš”"       |
| **Application**    | `application/`    | ì—…ë¬´ íë¦„ ì •ì˜     | "ê²Œì‹œê¸€ ì‘ì„±í•  ë•Œ ì œëª©ì´ ë¹„ì–´ìˆìœ¼ë©´ ì•ˆ ë¼ìš”" |
| **Infrastructure** | `infrastructure/` | ê¸°ìˆ ì  êµ¬í˜„        | "MySQL ë°ì´í„°ë² ì´ìŠ¤ì— INSERT ì¿¼ë¦¬ ì‹¤í–‰"      |
| **Presentation**   | `presentation/`   | ì‚¬ìš©ì ì ‘ì         | "POST /posts API ìš”ì²­ì„ ë°›ì•„ìš”"              |

---

## ğŸ”„ ì½”ë“œ íë¦„ ì´í•´í•˜ê¸°

### ì‹œë‚˜ë¦¬ì˜¤: "ìƒˆ ê²Œì‹œê¸€ ì‘ì„±í•˜ê¸°"

ì‚¬ìš©ìê°€ ê²Œì‹œê¸€ì„ ì‘ì„±í•  ë•Œ ì½”ë“œëŠ” ì´ëŸ° ìˆœì„œë¡œ ë™ì‘í•©ë‹ˆë‹¤:

```
ğŸ‘¤ ì‚¬ìš©ì
  â†“
  "ê²Œì‹œê¸€ì„ ì‘ì„±í•˜ê³  ì‹¶ì–´ìš”!"
  POST /posts { title: "ì•ˆë…•í•˜ì„¸ìš”", content: "ì²« ê²Œì‹œê¸€ì…ë‹ˆë‹¤" }
  â†“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1ï¸âƒ£ PRESENTATION LAYER (í”„ë ˆì  í…Œì´ì…˜ ì¸µ)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ post.routes.ts (ë¼ìš°í„°)
  â†“
  âœ… "ìš”ì²­ ë°›ì•˜ì–´ìš”!"
  âœ… "ì…ë ¥ê°’ì´ ì˜¬ë°”ë¥¸ì§€ ê²€ì¦í• ê²Œìš”" (Zod ìŠ¤í‚¤ë§ˆë¡œ ê²€ì¦)
  â†“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2ï¸âƒ£ APPLICATION LAYER (ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸µ)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ create-post.use-case.ts (ìœ ìŠ¤ì¼€ì´ìŠ¤)
  â†“
  âœ… "ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì²´í¬í• ê²Œìš”!"
     - ì œëª©ì´ ë¹„ì–´ìˆë‚˜ìš”? â†’ âŒ ì—ëŸ¬!
     - ë‚´ìš©ì´ ë¹„ì–´ìˆë‚˜ìš”? â†’ âŒ ì—ëŸ¬!
     - ì‘ì„±ìê°€ ë¹„ì–´ìˆë‚˜ìš”? â†’ âŒ ì—ëŸ¬!
  âœ… "ë°ì´í„° ì •ì œí• ê²Œìš”!" (ê³µë°± ì œê±° ë“±)
  â†“
  "Repositoryì•¼, ì´ê±° ì €ì¥í•´ì¤˜!"
  â†“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
3ï¸âƒ£ INFRASTRUCTURE LAYER (ì¸í”„ë¼ ì¸µ)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ drizzle-post.repository.ts (ì €ì¥ì†Œ êµ¬í˜„ì²´)
  â†“
  âœ… "ë°ì´í„°ë² ì´ìŠ¤ì— INSERT ì¿¼ë¦¬ ì‹¤í–‰!"
  âœ… "ìƒì„±ëœ ê²Œì‹œê¸€ ë‹¤ì‹œ ì¡°íšŒ!"
  â†“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
4ï¸âƒ£ DATABASE (ë°ì´í„°ë² ì´ìŠ¤)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ’¾ MySQL/MariaDB
  â†“
  âœ… "ì €ì¥ ì™„ë£Œ!"
  â†“

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ì—­ìˆœìœ¼ë¡œ ëŒì•„ê°€ê¸°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Repository â†’ UseCase â†’ Router â†’ ì‚¬ìš©ì
  â†“
ğŸ‘¤ ì‚¬ìš©ì
  "ê²Œì‹œê¸€ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!"
  { success: true, data: { id: 1, title: "ì•ˆë…•í•˜ì„¸ìš”", ... } }
```

### ì¸µ ê°„ í†µì‹  ê·œì¹™

```typescript
// âŒ ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë¼ìš”! (ì¸µì„ ê±´ë„ˆë›°ê¸°)
Router â†’ Database (ì§ì ‘ ì ‘ê·¼)

// âœ… ì´ë ‡ê²Œ í•´ì•¼ í•´ìš”! (ìˆœì„œëŒ€ë¡œ)
Router â†’ UseCase â†’ Repository â†’ Database
```

---

## ğŸ® ì‹¤ì œ ì˜ˆì œë¡œ ë”°ë¼ê°€ê¸°

### ì˜ˆì œ 1: ê²Œì‹œê¸€ ì‘ì„± (CREATE)

#### Step 1: ì‚¬ìš©ì ìš”ì²­

```http
POST http://localhost:3000/posts
Content-Type: application/json

{
  "title": "ì‚¼ì„±ì „ì ë¶„ì„",
  "content": "ì£¼ê°€ê°€ ìƒìŠ¹í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤",
  "author": "í™ê¸¸ë™",
  "stockCode": "005930",
  "stockName": "ì‚¼ì„±ì „ì"
}
```

#### Step 2: Router (presentation/routes/post.routes.ts)

```typescript
// API ìš”ì²­ì„ ë°›ì•„ìš”
postRouter.post("/", zValidator("json", createPostSchema), async (c) => {
  const data = c.req.valid("json"); // ê²€ì¦ëœ ë°ì´í„°

  // UseCaseì—ê²Œ ì¼ì„ ì‹œì¼œìš”
  const post = await createPostUseCase.execute(data);

  return c.json({ success: true, data: post }, 201);
});
```

**ì—­í• **:

- HTTP ìš”ì²­ ë°›ê¸°
- ì…ë ¥ê°’ ê²€ì¦ (Zod ìŠ¤í‚¤ë§ˆ)
- UseCase í˜¸ì¶œ
- HTTP ì‘ë‹µ ë°˜í™˜

#### Step 3: UseCase (application/use-cases/create-post.use-case.ts)

```typescript
class CreatePostUseCase {
  async execute(data: CreatePostInput): Promise<Post> {
    // ğŸ” ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦
    if (!data.title || data.title.trim().length === 0) {
      throw new Error("ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
    }

    if (!data.content || data.content.trim().length === 0) {
      throw new Error("ë‚´ìš©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
    }

    if (!data.author || data.author.trim().length === 0) {
      throw new Error("ì‘ì„±ìëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.");
    }

    // ğŸ§¹ ë°ì´í„° ì •ì œ
    const sanitizedData: CreatePostInput = {
      title: data.title.trim(),
      content: data.content.trim(),
      author: data.author.trim(),
      stockCode: data.stockCode?.trim() || undefined,
      stockName: data.stockName?.trim() || undefined,
    };

    // ğŸ’¾ Repositoryì—ê²Œ ì €ì¥ ìš”ì²­
    return await this.postRepository.create(sanitizedData);
  }
}
```

**ì—­í• **:

- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦ (ì œëª©/ë‚´ìš©/ì‘ì„±ì í•„ìˆ˜)
- ë°ì´í„° ì •ì œ (ê³µë°± ì œê±°)
- Repository í˜¸ì¶œ

#### Step 4: Repository (infrastructure/repositories/drizzle-post.repository.ts)

```typescript
class DrizzlePostRepository implements IPostRepository {
  async create(data: CreatePostInput): Promise<Post> {
    // ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ì— INSERT
    const result = await db.insert(posts).values({
      title: data.title,
      content: data.content,
      author: data.author,
      stockCode: data.stockCode,
      stockName: data.stockName,
    });

    // ìƒì„±ëœ IDë¡œ ë‹¤ì‹œ ì¡°íšŒ
    const insertId = Number(result[0].insertId);
    const created = await this.findById(insertId);

    if (!created) {
      throw new Error("ê²Œì‹œê¸€ ìƒì„± í›„ ì¡°íšŒ ì‹¤íŒ¨");
    }

    return created;
  }
}
```

**ì—­í• **:

- ì‹¤ì œ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì‹¤í–‰
- DB ê²°ê³¼ë¥¼ ë„ë©”ì¸ ì—”í‹°í‹°ë¡œ ë³€í™˜

#### Step 5: ê²°ê³¼ ë°˜í™˜

```json
{
  "success": true,
  "data": {
    "id": 1,
    "title": "ì‚¼ì„±ì „ì ë¶„ì„",
    "content": "ì£¼ê°€ê°€ ìƒìŠ¹í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤",
    "author": "í™ê¸¸ë™",
    "stockCode": "005930",
    "stockName": "ì‚¼ì„±ì „ì",
    "createdAt": "2025-10-17T10:30:00.000Z",
    "updatedAt": "2025-10-17T10:30:00.000Z"
  }
}
```

---

### ì˜ˆì œ 2: ê²Œì‹œê¸€ ëª©ë¡ ì¡°íšŒ (READ)

#### ì „ì²´ íë¦„ í•œëˆˆì— ë³´ê¸°

```
GET /posts
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ï¸âƒ£ Router (post.routes.ts)         â”‚
â”‚  "ê²Œì‹œê¸€ ëª©ë¡ ìš”ì²­ ë°›ì•˜ì–´ìš”!"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ï¸âƒ£ UseCase (get-all-posts.use-case)â”‚
â”‚  "Repositoryì•¼, ëª¨ë“  ê²Œì‹œê¸€ ì¤˜!"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ï¸âƒ£ Repository (drizzle-post)        â”‚
â”‚  SELECT * FROM posts                â”‚
â”‚  ORDER BY createdAt DESC            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ï¸âƒ£ Database                         â”‚
â”‚  ğŸ’¾ [ê²Œì‹œê¸€1, ê²Œì‹œê¸€2, ê²Œì‹œê¸€3...]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    ê²°ê³¼ë¥¼ ì—­ìˆœìœ¼ë¡œ ë°˜í™˜
    â†“
ğŸ‘¤ ì‚¬ìš©ìì—ê²Œ JSON ì‘ë‹µ
```

#### ì½”ë“œë¡œ ë³´ê¸°

```typescript
// 1ï¸âƒ£ Router
postRouter.get("/", async (c) => {
  const posts = await getAllPostsUseCase.execute();
  return c.json({ success: true, data: posts });
});

// 2ï¸âƒ£ UseCase
class GetAllPostsUseCase {
  async execute(): Promise<Post[]> {
    return await this.postRepository.findAll();
  }
}

// 3ï¸âƒ£ Repository
class DrizzlePostRepository {
  async findAll(): Promise<Post[]> {
    const result = await db.select().from(posts).orderBy(desc(posts.createdAt)); // ìµœì‹ ìˆœ ì •ë ¬

    return result.map(this.toDomain);
  }
}
```

---

### ì˜ˆì œ 3: ê²Œì‹œê¸€ ìˆ˜ì • (UPDATE)

#### íë¦„

```
PUT /posts/1
    â†“
    "IDê°€ 1ì¸ ê²Œì‹œê¸€ì˜ ì œëª©ì„ ë°”ê¾¸ê³  ì‹¶ì–´ìš”!"
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Router: ID ê²€ì¦ â†’ UseCase í˜¸ì¶œ                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UseCase: ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì²´í¬                    â”‚
â”‚  - ìˆ˜ì •í•  ë‚´ìš©ì´ ìˆë‚˜ìš”?                       â”‚
â”‚  - ê³µë°± ì œê±°                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Repository:                                  â”‚
â”‚  1. ê²Œì‹œê¸€ ì¡´ì¬ í™•ì¸                          â”‚
â”‚  2. UPDATE ì¿¼ë¦¬ ì‹¤í–‰                         â”‚
â”‚  3. ìˆ˜ì •ëœ ê²Œì‹œê¸€ ë‹¤ì‹œ ì¡°íšŒ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
    ìˆ˜ì •ëœ ê²Œì‹œê¸€ ë°˜í™˜
```

#### ì½”ë“œ

```typescript
// UseCase
class UpdatePostUseCase {
  async execute(id: number, data: UpdatePostInput): Promise<Post | null> {
    // ìˆ˜ì •í•  ë‚´ìš©ì´ ìˆëŠ”ì§€ í™•ì¸
    if (Object.keys(data).length === 0) {
      throw new Error("ìˆ˜ì •í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.");
    }

    // ë°ì´í„° ì •ì œ
    const sanitizedData: UpdatePostInput = {};
    if (data.title !== undefined) {
      sanitizedData.title = data.title.trim();
    }
    // ... ë‹¤ë¥¸ í•„ë“œë“¤ë„ ì •ì œ

    return await this.postRepository.update(id, sanitizedData);
  }
}

// Repository
async update(id: number, data: UpdatePostInput): Promise<Post | null> {
  // 1. ì¡´ì¬ í™•ì¸
  const existing = await this.findById(id);
  if (!existing) return null;

  // 2. ìˆ˜ì •
  await db.update(posts).set(data).where(eq(posts.id, id));

  // 3. ìˆ˜ì •ëœ ë‚´ìš© ë°˜í™˜
  return await this.findById(id);
}
```

---

## ğŸ’¡ ì™œ ì´ë ‡ê²Œ ë³µì¡í•˜ê²Œ ë‚˜ëˆŒê¹Œìš”?

### ê°„ë‹¨í•œ ì½”ë“œ vs í´ë¦° ì•„í‚¤í…ì²˜

#### âŒ ê°„ë‹¨í•˜ê²Œ í•œ íŒŒì¼ì— ë‹¤ ì“°ë©´ ì•ˆ ë ê¹Œìš”?

```typescript
// ëª¨ë“  ê²ƒì´ ì„ì¸ ë‚˜ìœ ì˜ˆ
app.post("/posts", async (req, res) => {
  // HTTP, ê²€ì¦, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§, DB ì¿¼ë¦¬ê°€ ëª¨ë‘ ì„ì—¬ìˆìŒ
  const { title, content } = req.body;

  if (!title) return res.status(400).json({ error: "ì œëª© í•„ìˆ˜" });

  const result = await db.query("INSERT INTO posts (title, content) VALUES (?, ?)", [title, content]);

  res.json({ id: result.insertId });
});
```

**ë¬¸ì œì **:

- ğŸ”´ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ì›€ (HTTP ì„œë²„ë¥¼ ë„ì›Œì•¼ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥)
- ğŸ”´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë°”ê¾¸ë©´? ëª¨ë“  ì½”ë“œ ìˆ˜ì •
- ğŸ”´ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ì´ ì–´ë””ìˆëŠ”ì§€ ì°¾ê¸° ì–´ë ¤ì›€
- ğŸ”´ ì¬ì‚¬ìš© ë¶ˆê°€ëŠ¥ (CLIì—ì„œ ì“°ê³  ì‹¶ì–´ë„ ëª» ì”€)

#### âœ… í´ë¦° ì•„í‚¤í…ì²˜ë¡œ ë‚˜ëˆ„ë©´?

```typescript
// ê°ìì˜ ì—­í• ì´ ëª…í™•
Router â†’ UseCase â†’ Repository â†’ Database
```

**ì¥ì **:

- âœ… ê° ë¶€ë¶„ì„ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- âœ… ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ë°”ê¿”ë„ Repositoryë§Œ ìˆ˜ì •
- âœ… ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ UseCaseì— ëª…í™•íˆ ì •ë¦¬ë¨
- âœ… CLI, API, ì›¹ ëª¨ë‘ì—ì„œ ê°™ì€ UseCase ì¬ì‚¬ìš© ê°€ëŠ¥

---

## ğŸ”‘ í•µì‹¬ ê°œë… ì •ë¦¬

### 1. ì˜ì¡´ì„± ì—­ì „ ì›ì¹™ (Dependency Inversion)

```typescript
// âŒ ë‚˜ìœ ì˜ˆ: ì§ì ‘ ì˜ì¡´
class CreatePostUseCase {
  private repository = new MySQLPostRepository(); // MySQLì— ì§ì ‘ ì˜ì¡´!
}

// âœ… ì¢‹ì€ ì˜ˆ: ì¸í„°í˜ì´ìŠ¤ ì˜ì¡´
class CreatePostUseCase {
  constructor(private repository: IPostRepository) {} // ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
}

// ì‚¬ìš©í•  ë•Œ ì£¼ì…
const repository = new DrizzlePostRepository(); // ë˜ëŠ” MongoPostRepository
const useCase = new CreatePostUseCase(repository);
```

**ì¥ì **: DBë¥¼ ë°”ê¿”ë„ UseCase ì½”ë“œëŠ” ì•ˆ ë°”ë€œ!

### 2. ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬ (Separation of Concerns)

| ê´€ì‹¬ì‚¬           | ë‹´ë‹¹ ì¸µ        | ì˜ˆì‹œ                      |
| ---------------- | -------------- | ------------------------- |
| ì‚¬ìš©ì ì…ë ¥ ê²€ì¦ | Presentation   | "JSONì´ ì˜¬ë°”ë¥¸ í˜•ì‹ì¸ê°€?" |
| ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™    | Application    | "ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤"       |
| ë°ì´í„° ì €ì¥      | Infrastructure | "MySQL INSERT ì¿¼ë¦¬"       |
| ë¹„ì¦ˆë‹ˆìŠ¤ ê°œë…    | Domain         | "ê²Œì‹œê¸€ì€ ë¬´ì—‡ì¸ê°€?"      |

### 3. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (Single Responsibility)

```typescript
// âœ… ê° í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ
class CreatePostUseCase {
  // ì±…ì„: "ê²Œì‹œê¸€ ìƒì„±" ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ
}

class DrizzlePostRepository {
  // ì±…ì„: "Drizzle ORMì„ ì‚¬ìš©í•œ ë°ì´í„° ì ‘ê·¼"ë§Œ
}

class PostRouter {
  // ì±…ì„: "HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬"ë§Œ
}
```

---

## ğŸ“Š ì „ì²´ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ğŸ‘¤ ì‚¬ìš©ì (ë¸Œë¼ìš°ì €/ì•±)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â†“ HTTP ìš”ì²­
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                   ğŸŒ PRESENTATION LAYER                        â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”ƒ
â”ƒ  â”‚   Router     â”‚  â”‚   Schema     â”‚  â”‚  Validator   â”‚        â”ƒ
â”ƒ  â”‚ post.routes  â”‚â†’ â”‚ post.schema  â”‚â†’ â”‚   (Zod)      â”‚        â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                              â”‚
                              â†“ ê²€ì¦ëœ ë°ì´í„°
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                   ğŸ’¼ APPLICATION LAYER                         â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”ƒ
â”ƒ  â”‚              Use Cases (ì—…ë¬´ ë¡œì§)                  â”‚       â”ƒ
â”ƒ  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚       â”ƒ
â”ƒ  â”‚  â”‚ Create   â”‚ â”‚ GetAll   â”‚ â”‚ Update   â”‚  ...      â”‚       â”ƒ
â”ƒ  â”‚  â”‚ Post     â”‚ â”‚ Posts    â”‚ â”‚ Post     â”‚           â”‚       â”ƒ
â”ƒ  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚       â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                              â”‚
                              â†“ Repository ì¸í„°í˜ì´ìŠ¤ í˜¸ì¶œ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                      ğŸ§  DOMAIN LAYER                           â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”ƒ
â”ƒ  â”‚   Entities   â”‚           â”‚    Repository        â”‚          â”ƒ
â”ƒ  â”‚              â”‚           â”‚    Interface         â”‚          â”ƒ
â”ƒ  â”‚ Post         â”‚    â†â”€â”€â”€â”€â”€â”€â”‚ IPostRepository      â”‚          â”ƒ
â”ƒ  â”‚ (ë¹„ì¦ˆë‹ˆìŠ¤    â”‚           â”‚ (ê³„ì•½ ì •ì˜)           â”‚          â”ƒ
â”ƒ  â”‚  ê°œë… ì •ì˜)   â”‚           â”‚                      â”‚          â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                              â†‘
                              â”‚ ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                   ğŸ”§ INFRASTRUCTURE LAYER                      â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”ƒ
â”ƒ  â”‚         Repository êµ¬í˜„ì²´                         â”‚         â”ƒ
â”ƒ  â”‚  DrizzlePostRepository                           â”‚         â”ƒ
â”ƒ  â”‚  (IPostRepository ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„)               â”‚         â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”ƒ
â”ƒ                       â”‚                                        â”ƒ
â”ƒ                       â†“ ORM ì‚¬ìš©                               â”ƒ
â”ƒ  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”ƒ
â”ƒ  â”‚   Drizzle    â”‚  â”‚   Schema     â”‚                          â”ƒ
â”ƒ  â”‚   (ORM)      â”‚  â”‚  (í…Œì´ë¸”)     â”‚                          â”ƒ
â”ƒ  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›
                              â”‚
                              â†“ SQL ì¿¼ë¦¬
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ’¾ DATABASE (MySQL/MariaDB)                  â”‚
â”‚              posts í…Œì´ë¸” (id, title, content, ...)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ í•™ìŠµ íŒ

### 1. ì½”ë“œ ì½ëŠ” ìˆœì„œ ì¶”ì²œ

ì²˜ìŒ ë³´ëŠ” ë¶„ë“¤ì€ ì´ ìˆœì„œë¡œ ì½ì–´ë³´ì„¸ìš”:

1. **`domain/entities/post.entity.ts`**
   â†’ "ê²Œì‹œê¸€ì´ ë­”ì§€" ì´í•´

2. **`domain/repositories/post.repository.interface.ts`**
   â†’ "ê²Œì‹œê¸€ë¡œ ë­˜ í•  ìˆ˜ ìˆëŠ”ì§€" ì´í•´

3. **`application/use-cases/create-post.use-case.ts`**
   â†’ "ê²Œì‹œê¸€ì„ ì–´ë–»ê²Œ ì‘ì„±í•˜ëŠ”ì§€" ì´í•´

4. **`infrastructure/repositories/drizzle-post.repository.ts`**
   â†’ "ì‹¤ì œë¡œ ì–´ë–»ê²Œ ì €ì¥í•˜ëŠ”ì§€" ì´í•´

5. **`presentation/routes/post.routes.ts`**
   â†’ "APIë¡œ ì–´ë–»ê²Œ í˜¸ì¶œí•˜ëŠ”ì§€" ì´í•´

### 2. ì§ì ‘ í•´ë³´ê¸°

1. **ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€í•´ë³´ê¸°**:

   ```
   ì˜ˆ: "ê²Œì‹œê¸€ ì¢‹ì•„ìš” ê¸°ëŠ¥"
   1. domain/entitiesì— likes í•„ë“œ ì¶”ê°€
   2. repository interfaceì— incrementLikes ë©”ì„œë“œ ì¶”ê°€
   3. use-caseì— LikePostUseCase ìƒì„±
   4. infrastructureì—ì„œ êµ¬í˜„
   5. presentationì—ì„œ API ì¶”ê°€
   ```

2. **ë°ì´í„°ë² ì´ìŠ¤ ë°”ê¿”ë³´ê¸°**:
   ```
   Drizzle â†’ Prisma ë˜ëŠ” TypeORMìœ¼ë¡œ ë°”ê¿”ë„
   Domain, Application ì¸µì€ ì „í˜€ ìˆ˜ì • ì•ˆ í•´ë„ ë¨!
   Infrastructureë§Œ ë°”ê¾¸ë©´ ë!
   ```

### 3. í…ŒìŠ¤íŠ¸ ì‘ì„±í•´ë³´ê¸°

```typescript
// UseCaseëŠ” ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥!
describe("CreatePostUseCase", () => {
  it("ì œëª©ì´ ì—†ìœ¼ë©´ ì—ëŸ¬", async () => {
    const mockRepository = {
      /* mock */
    };
    const useCase = new CreatePostUseCase(mockRepository);

    await expect(useCase.execute({ title: "", content: "test", author: "test" })).rejects.toThrow("ì œëª©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤");
  });
});
```

---

## â“ ìì£¼ ë¬»ëŠ” ì§ˆë¬¸ (FAQ)

### Q1: ì™œ ì´ë ‡ê²Œ íŒŒì¼ì´ ë§ì•„ìš”? ë³µì¡í•´ìš”!

**A**: ì²˜ìŒì—” ë³µì¡í•´ ë³´ì´ì§€ë§Œ, í”„ë¡œì íŠ¸ê°€ ì»¤ì§ˆìˆ˜ë¡ ë¹›ì„ ë°œí•©ë‹ˆë‹¤!

```
ì‘ì€ í”„ë¡œì íŠ¸ (íŒŒì¼ 10ê°œ):
- ê°„ë‹¨í•œ ë°©ì‹: ğŸ‘ ë¹ ë¥´ê³  ì‰¬ì›€
- í´ë¦° ì•„í‚¤í…ì²˜: ğŸ˜ ì¢€ ë³µì¡í•¨

í° í”„ë¡œì íŠ¸ (íŒŒì¼ 1000ê°œ):
- ê°„ë‹¨í•œ ë°©ì‹: ğŸ’€ ìŠ¤íŒŒê²Œí‹° ì½”ë“œ, ìœ ì§€ë³´ìˆ˜ ì§€ì˜¥
- í´ë¦° ì•„í‚¤í…ì²˜: âœ¨ ê¹”ë”í•˜ê²Œ ì •ë¦¬ë¨, ì°¾ê¸° ì‰¬ì›€
```

### Q2: ëª¨ë“  í”„ë¡œì íŠ¸ì— í´ë¦° ì•„í‚¤í…ì²˜ë¥¼ ì¨ì•¼ í•˜ë‚˜ìš”?

**A**: ì•„ë‹ˆìš”! í”„ë¡œì íŠ¸ ê·œëª¨ì— ë”°ë¼ ì„ íƒí•˜ì„¸ìš”.

- âœ… **ì í•©í•œ ê²½ìš°**:

  - íŒ€ í”„ë¡œì íŠ¸
  - ì¥ê¸° ìœ ì§€ë³´ìˆ˜ê°€ í•„ìš”í•œ í”„ë¡œì íŠ¸
  - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë³µì¡í•œ ê²½ìš°
  - ì—¬ëŸ¬ ì¸í„°í˜ì´ìŠ¤(API, CLI, ì›¹)ê°€ í•„ìš”í•œ ê²½ìš°

- âŒ **ê³¼í•œ ê²½ìš°**:
  - ê°„ë‹¨í•œ ê°œì¸ í”„ë¡œì íŠ¸
  - í”„ë¡œí† íƒ€ì…
  - ì¼íšŒì„± ìŠ¤í¬ë¦½íŠ¸

### Q3: UseCaseê°€ Repositoryë§Œ í˜¸ì¶œí•˜ëŠ”ë° ì™œ í•„ìš”í•œê°€ìš”?

**A**: ì§€ê¸ˆì€ ë‹¨ìˆœí•´ ë³´ì—¬ë„, ë‚˜ì¤‘ì— ë³µì¡í•´ì§ˆ ìˆ˜ ìˆì–´ìš”!

```typescript
// ì§€ê¸ˆì€ ë‹¨ìˆœ
class GetAllPostsUseCase {
  async execute(): Promise<Post[]> {
    return await this.repository.findAll();
  }
}

// ë‚˜ì¤‘ì— ìš”êµ¬ì‚¬í•­ ì¶”ê°€
class GetAllPostsUseCase {
  async execute(userId?: number): Promise<Post[]> {
    const posts = await this.repository.findAll();

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¶”ê°€
    // - ì‚¬ìš©ìë³„ ê¶Œí•œ ì²´í¬
    // - í•„í„°ë§
    // - ì •ë ¬
    // - ìºì‹±
    // - ë¡œê¹…

    return posts;
  }
}
```

### Q4: Interfaceì™€ êµ¬í˜„ì²´ë¥¼ ë”°ë¡œ ë‘ëŠ” ì´ìœ ëŠ”?

**A**: ìœ ì—°ì„±ê³¼ í…ŒìŠ¤íŠ¸ ìš©ì´ì„±!

```typescript
// Production í™˜ê²½
const repository = new DrizzlePostRepository(); // ì§„ì§œ DB

// Test í™˜ê²½
const repository = new MockPostRepository(); // ê°€ì§œ DB

// CLI í™˜ê²½
const repository = new FilePostRepository(); // íŒŒì¼ì— ì €ì¥

// ê°™ì€ UseCase ì¬ì‚¬ìš©!
const useCase = new CreatePostUseCase(repository);
```

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

ì´ì œ í´ë¦° ì•„í‚¤í…ì²˜ì™€ DDDì˜ ê¸°ë³¸ì„ ì´í•´í–ˆë‹¤ë©´:

1. **ì½”ë“œ ì§ì ‘ ìˆ˜ì •í•´ë³´ê¸°**

   - ìƒˆë¡œìš´ í•„ë“œ ì¶”ê°€
   - ìƒˆë¡œìš´ UseCase ë§Œë“¤ê¸°
   - ê²€ì¦ ê·œì¹™ ì¶”ê°€í•˜ê¸°

2. **í…ŒìŠ¤íŠ¸ ì‘ì„±í•´ë³´ê¸°**

   - UseCase ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
   - Repository Mock í…ŒìŠ¤íŠ¸

3. **ë‹¤ë¥¸ ê¸°ëŠ¥ ì¶”ê°€í•´ë³´ê¸°**

   - ëŒ“ê¸€ ê¸°ëŠ¥
   - ì¢‹ì•„ìš” ê¸°ëŠ¥
   - ê²€ìƒ‰ ê¸°ëŠ¥

4. **ì‹¬í™” í•™ìŠµ**
   - CQRS íŒ¨í„´
   - Event Sourcing
   - Hexagonal Architecture

---

## ğŸ“š ì°¸ê³  ìë£Œ

- **í´ë¦° ì•„í‚¤í…ì²˜**: Robert C. Martinì˜ "Clean Architecture" ì±…
- **DDD**: Eric Evansì˜ "Domain-Driven Design" ì±…
- **ì‹¤ì „ ì˜ˆì œ**: ì´ í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ ì§ì ‘ ì½ì–´ë³´ì„¸ìš”!

---

## ğŸ‰ ë§ˆë¬´ë¦¬

ì¶•í•˜í•©ë‹ˆë‹¤! ì´ì œ ì—¬ëŸ¬ë¶„ì€:

âœ… í´ë¦° ì•„í‚¤í…ì²˜ê°€ ë¬´ì—‡ì¸ì§€ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤  
âœ… DDDì˜ í•µì‹¬ ê°œë…(Entity, Repository, UseCase)ì„ ì´í•´í–ˆìŠµë‹ˆë‹¤  
âœ… ì½”ë“œê°€ ì–´ë–»ê²Œ íë¥´ëŠ”ì§€ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤  
âœ… ì™œ ì´ë ‡ê²Œ ì„¤ê³„í•˜ëŠ”ì§€ ì´ìœ ë¥¼ ì•Œê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤

**í•µì‹¬ ê¸°ì–µí•  ê²ƒ**:

1. **Domain(ë¹„ì¦ˆë‹ˆìŠ¤)ì´ ì¤‘ì‹¬**
2. **ë°”ê¹¥ì¸µì€ ì•ˆìª½ì¸µì— ì˜ì¡´** (ì—­ì€ ì•ˆ ë¨)
3. **ê° ì¸µì€ ìê¸° ì±…ì„ë§Œ**
4. **Interfaceë¡œ ìœ ì—°ì„± í™•ë³´**

ì²˜ìŒì—” ë³µì¡í•´ ë³´ì´ì§€ë§Œ, ì½”ë“œë¥¼ ì½ê³  ìˆ˜ì •í•˜ë‹¤ ë³´ë©´ ìì—°ìŠ¤ëŸ½ê²Œ ì´í•´ê°€ ë  ê±°ì˜ˆìš”! ğŸ’ª

Happy Coding! ğŸš€
